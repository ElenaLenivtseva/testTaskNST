# testTaskNST
## Структура
Фреймворки я только начинаю изучать, поэтому компонент представлен другим образом.
В разработке был задействован GULP, поэтому в dist – собранные файлы, для чтения и для разработки. В src – исходный код. Прикрепила и dist тоже, на всякий случай. Поговорим про src.

Есть один файл HTML с базовой разметкой таймлайна. Есть файл со стилями, объединивший в себя несколько файлов, написанных на SASS. Reset– обнуление всех стилей; vars – переменные с цветами и шрифтами, breakpoints для media-запросов; mixin – миксин для работы с media-запросами; timeline – стили самого таймлайна, также в нем находятся свои стили для слайдера на Slick. Основной скрипт собран из: timeline.js – основная логика отображения дат, slider.js – создание адаптивного слайдера из таймлайна, switcher.js – логика переключателя между таймлайном лет и таймлайном месяцев. Также есть slick.min.js – этот файл подключается в index.html, чтобы работал слайдер.

### Switcher.js
При нажатии на блок навигации отслеживается, на каком пункте произошел клик. Меняются классы (добавляются/удаляются). В css заложена зависимость от данных классов – суть в изменении прозрачности и цвета текста таймлайна. Например, если выбрали таймлайн года, то подписи к месяцам становятся прозрачными, а заголовки годов – более светлыми. Это делает переключение достаточно быстрым, ведь не меняется структура таймлайна.

### Slider.js
В index.html подключены библиотеки: JQuery и плагин Slick. В slider.js инициализируются слайдеры из index.html. Т.к. таймлайн разделен на 2 идентичных по строению части (верх и низ), одинаковых по размеру, обе эти части превращены в слайдеры. Они зависят друг от друга: при листании периодов (верха), листается и их описание (низ). 

### Timeline.js
Функция main – основная. В нее нужно передать следующие параметры: минимальную дату слайдера, максимальную дату слайдера, дату начала периода, дату окончания периода.
Первым делом происходит проверка на корректность введенных данных – нельзя указывать минимальную дату больше максимальной, нельзя ставить начало периода позже его конца, также происходит проверка на соответствие периода диапазону между минимальной и максимальной датой.

У каждого параметра находится год (в виде числа). У дат периодов находятся еще и месяца. У мин. и макс. точек - нет, потому что слайдер начинается с января минимально установленного года.

Таймлайн (по HTML) делится на 2 части: верхняя отвечает за отображение периода, нижняя - за подписи. По структуре они идентичны. В подготовленные элементы в HTML-разметке помещается столько потомков (годов), сколько лет разницы между минимальной датой и максимальной. Ширина потомка равна той части слайдера, которую он занимает (н-р, если ½, всего два года в диапазоне, то каждый по 50%). В каждый год добавляется 12 элементов с текстовым содержимым – это месяца. Году задаются такие стили, чтобы каждый месяц занимал 1/12 его ширины. В первый месяц первого года заносится минимальная дата таймлайна (н-р, 2018). В первый месяц последнего года, соответственно, максимальная дата таймлайна (н-р, 2020). У последнего года указан лишь один месяц, т.к. это конечная точка таймлайна. Также его ширина должна определяться размером содержимого, а не частью всего таймлайна. В целом, в значение первого месяца любого года, входящего в диапазон, ставится год.

Каждому году-элементу дается data-атрибут, в котором заключается число этого года (data-year = "2022" и т.п.). Это делается для дальнейшей отрисовки периода в верхней части таймлайна.

Отрисовкой занимается функция searchFill. Ей передаются даты периодов и родительский элемент, в котором должна происходить отрисовка.

Во-первых, мы получаем «координаты» точек экстремума (год-месяц). Этим точкам задаем классы, чтобы они выглядели необходимым образом. Также мы отслеживаем события, происходящие с каждой из этих точек. При размере экрана от 800px мы отслеживаем наведение. Если пользователь наводит мышь на точку, создается тултип с «координатами» точки – месяцем и годом. При размере экрана происходит то же самое, но при клике. Первый клик – тултип создан, второй клик – тултип удален, третий клик – создан и т.д.

Между этими точками – окрашенная линия, отличающая период от непериодов на таймлайне.

Есть несколько случаев, когда передают даты. Например, между минимальной датой периода и максимальной может быть больше года (2018 и 2020), год (2018 и 2019) и всего лишь несколько месяцев. В последнем случае находятся «координаты» (месяц-элемент в нужном год-элементе) минимальной и максимальной дат. Находится год минимальной точка (даты) и ей, и всем последующим элементам до максимальной точки (даты) добавляется класс (__betweenPoint). Этот класс закрашивает фон в определенный цвет. В двух остальных случаях (разница между датами один год, разница – более одного года) отрисовка происходит так: если это минимальная точка от нее и до последнего месяца года элементам назначается класс __betweenPoint (т.е. мы как бы говорим ей «разукрась все месяца в этом году после меня»). Если максимальная – то же самое, но в обратном порядке («разукрась все месяца в этом году до меня»). В случае, когда разница – один год, этого достаточно. В случае, когда разница свыше этого – класс дополнительно добавляется всем месяцам всех лет, что находятся между годами максимальной и минимальной даты (если наш период 2018-2022 год, то окрашиваются 2019-2021. Года, содержащие точки экстремума окрасятся по предыдущей логике).

---
#####Баги
Из-за плагина Slick скрывается часть линии таймлайна, а также тултипы. Т.е. они есть, но они скрыты. Изменение overflow невозможно, потому что свойство задано на элементе плагина. При искусственном изменении overflow, плагин перестает работать, ломая всю структуру таймлайна. Пришлось выбирать между скроллом на блоке таймлайна и отсутствием тултипов.  Тайже из-за плагина изменилась ширина последнего года, из-за чего появилось пустое пространство между последним годом и концом слайдера.

Если вы знаете, как решить эти проблемы, подскажите мне, пожалуйста: lenivtseva.lena.@yandex.ru
